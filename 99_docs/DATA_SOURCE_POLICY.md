# DATA_SOURCE_POLICY

데이터 소스 선정 근거 및 운영 원칙

---

## 1. 데이터 소스 선정 원칙

### 1.1 핵심 원칙
1. **무료 또는 저비용**: 개인 프로젝트 예산 고려
2. **API 안정성**: 장기간 운영 가능한 공식 API 우선
3. **데이터 신뢰성**: 공공기관/신뢰 기관 데이터 우선
4. **업데이트 주기**: 일간 이상 업데이트되는 데이터
5. **히스토리 접근성**: 과거 데이터 수집 가능 여부

### 1.2 데이터 품질 기준
- **완전성**: 결측치 최소화
- **적시성**: 실시간 또는 D+0 업데이트
- **정확성**: 공식 발표 기관 데이터
- **일관성**: 데이터 형식 및 구조 통일

---

## 2. 주가 데이터

### 2.1 선정 소스: yfinance
- **제공자**: Yahoo Finance (Python 라이브러리)
- **비용**: 무료
- **업데이트 주기**: 실시간 (15분 지연)
- **히스토리**: 수년~수십년 데이터 접근 가능

### 2.2 선정 이유
| 항목 | 이유 |
|------|------|
| 접근성 | Python 라이브러리로 간편 사용 |
| 커버리지 | 한국, 미국 주식시장 모두 지원 |
| 안정성 | 오랜 기간 서비스 제공 |
| 데이터 품질 | OHLCV 정확도 높음 |
| 무료 | API 키 불필요, 무제한 사용 |

### 2.3 대안 검토
| 소스 | 장점 | 단점 | 선정 여부 |
|------|------|------|-----------|
| 한국투자증권 API | 실시간 데이터 | 계좌 개설 필요, 복잡한 인증 | ❌ |
| KRX 시장데이터 | 공식 데이터 | API 미제공, 수동 다운로드 | ❌ |
| Alpha Vantage | 무료 API | 일 25회 제한, 느린 속도 | ❌ |
| yfinance | 무료, 간편, 안정적 | 15분 지연 | ✅ 채택 |

### 2.4 수집 종목 선정 기준

#### 한국 종목 (27개)
| 기준 | 내용 |
|------|------|
| 시가총액 | 상위 종목 우선 |
| 섹터 대표성 | 반도체, 2차전지, 금융, 엔터 등 주요 섹터 포함 |
| 경제 민감도 | 경기 사이클 반영 종목 |
| 금리 민감도 | 금리 변동 영향 종목 (금융주) |
| 환율 민감도 | 수출 비중 높은 종목 |
| K-콘텐츠 대표성 | 엔터, 게임, 미디어 산업 포함 |

#### 미국 종목 (11개)
| 기준 | 내용 |
|------|------|
| 주요 지수 | S&P500, 나스닥, VIX |
| ETF 대표성 | QQQ (기술주), SPY (시장), TLT (채권), GLD (금) |
| 글로벌 영향력 | 미국 시장이 한국 시장에 미치는 영향 분석용 |

---

## 3. 경제지표 데이터

### 3.1 한국 경제지표: 한국은행 ECOS API

#### 선정 이유
- **공신력**: 한국은행 공식 API
- **무료**: 무제한 사용 (키 발급 필요)
- **데이터 범위**: 환율, 금리, GDP, CPI 등 주요 지표 제공
- **히스토리**: 수십년 과거 데이터 접근 가능

#### 수집 지표 선정 기준
| 지표 | 선정 이유 |
|------|----------|
| 원/달러 환율 | 수출 기업 실적에 직접 영향 |
| 원/엔 환율 | 일본 경쟁 관계 분석 |
| 원/유로 환율 | 유럽 시장 영향 분석 |
| 기준금리 | 금융주 및 채권시장 영향 |
| GDP (분기별) | 경기 사이클 분석 |
| CPI (월별) | 물가 및 금리 정책 연관 |

#### GDP 데이터 특이사항
- **통계코드**: 200Y102 (주요지표-분기지표)
- **항목 수**: 52개 (실질 GDP, 민간소비, 정부소비, 설비투자, 건설투자, 수출/수입 등)
- **주기**: 분기별 (Q1, Q2, Q3, Q4)
- **용도**: 경기 사이클 판단, 소비/투자 트렌드 분석

### 3.2 미국 경제지표: FRED API

#### 선정 이유
- **공신력**: 미국 연방준비은행(Federal Reserve) 공식 API
- **무료**: API 키 발급 후 무제한 사용
- **데이터 범위**: 50만+ 경제 시계열 데이터
- **글로벌 영향**: 미국 경제지표가 한국 시장에 미치는 영향 분석

#### 수집 지표 선정 기준
| 지표 | FRED ID | 선정 이유 |
|------|---------|----------|
| 10년물 국채금리 | DGS10 | 안전자산 수요, 경기 전망 |
| 실업률 | UNRATE | 경기 상황 판단 |
| 소비자물가지수 | CPIAUCSL | 인플레이션 추세 |
| 달러인덱스 | DTWEXBGS | 글로벌 달러 강세/약세 |
| WTI 유가 | DCOILWTICO | 에너지 비용, 물가 영향 |

---

## 4. 뉴스 데이터

### 4.1 선정 소스: 네이버 검색 API

#### 선정 이유
- **접근성**: 무료 API (일 25,000건)
- **한국어 커버리지**: 국내 주요 언론사 뉴스 포함
- **실시간성**: 최신 뉴스 즉시 수집 가능
- **간편성**: JSON 형식 제공, 파싱 용이

#### 한계 및 대안
| 한계 | 대안 |
|------|------|
| 과거 날짜 필터링 미지원 | 빅카인즈(bigkinds.or.kr) 수동 다운로드 |
| 최신 2~3일 뉴스만 수집 | 일간 수집으로 히스토리 축적 |
| 키워드 검색 한정 | 주요 경제 키워드 4개 선정 |

### 4.2 뉴스 키워드 선정 기준
| 키워드 | 선정 이유 |
|--------|----------|
| 경제 | 거시경제 이슈 포괄 |
| 부동산 | 자산시장 트렌드 |
| 반도체 | 한국 수출 핵심 산업 |
| 코스피 | 주식시장 직접 언급 |

---

## 5. 데이터 수집 주기 정책

### 5.1 Cron 스케줄 설계 원칙
- **시장 마감 후 수집**: 장마감 가격 확정 후 데이터 수집
- **1일 3회 수집**: 미국/한국 시장 모두 커버
- **중복 방지**: CSV 저장 시 중복 제거 로직

### 5.2 수집 시간대 설정
| 시간 | 수집 항목 | 근거 |
|------|-----------|------|
| 08:00 | 미국 주가 + 경제지표 + 뉴스 | 미국 장마감(06:00 KST) 이후 |
| 16:00 | 한국 주가 + 경제지표 + 뉴스 | 한국 장마감(15:30 KST) 이후 |
| 20:00 | 경제지표 + 뉴스 | 저녁 뉴스 반영 |

---

## 6. 히스토리 데이터 정책

### 6.1 수집 기간: 15년 (2010-2025)

#### 선정 이유
| 근거 | 설명 |
|------|------|
| 통계적 유의성 | 5년은 경기 사이클 1~2회, 15년은 3~4회 포함 |
| 장기 트렌드 분석 | 10년 이상 데이터로 구조적 변화 파악 |
| 주요 이벤트 포함 | 2010년대 유로존 위기, 2020 코로나 팬데믹 등 |
| 데이터 가용성 | yfinance, FRED, ECOS 모두 15년 이상 데이터 제공 |

### 6.2 분할 수집 전략 (3개 Period)
- **Period 1**: 2010-2014 (5년)
- **Period 2**: 2015-2019 (5년)
- **Period 3**: 2020-2025 (5년)

#### 이유
- API 타임아웃 방지
- 메모리 효율 관리
- 병렬 처리 가능
- 중간 검증 용이

---

## 7. 데이터 품질 관리

### 7.1 결측치 처리 원칙
| 원인 | 처리 방법 |
|------|----------|
| 주말/공휴일 | forward-fill + `is_holiday_gap=True` 플래그 |
| API 오류 | NaN 유지, 로그 기록 |
| 상장 전 데이터 | NaN 유지 (예: LG에너지솔루션 2022년 이전) |

### 7.2 중복 제거 원칙
- **주가**: `['date', 'name']` 기준, 마지막 레코드 유지
- **경제지표**: `['date', 'indicator']` 기준, 지표별 중복 방지
- **뉴스**: 제목 유사도(Jaccard>0.8) + 1시간 이내 중복 제거

### 7.3 데이터 검증
| 검증 항목 | 기준 |
|----------|------|
| 레코드 수 | 예상 범위 내 (±10%) |
| 날짜 범위 | 시작/종료일 일치 |
| 결측치 비율 | 주가 5% 이하, 지표 10% 이하 |
| 이상치 | z-score ±5 이상 플래깅 |

---

## 8. 저장소 정책

### 8.1 이중 저장 전략: CSV + InfluxDB

#### CSV 저장
- **용도**: 백업, 오프라인 분석, 데이터 검증
- **경로**: `/raspi/WD4T/00_data_raw/`
- **인코딩**: UTF-8-SIG (한글 호환)

#### InfluxDB 저장
- **용도**: 상시 모니터링, Grafana 연동, 시계열 분석
- **Bucket**: `econ_market`
- **Retention**: 무제한 (Infinite)

### 8.2 데이터 모델 (InfluxDB)
| Measurement | Tags | Fields |
|-------------|------|--------|
| stock_prices | name, ticker | open, high, low, close, volume |
| economic_indicators | indicator, source, period | value |
| news | keyword | title, description, link, count |

---

## 9. 비용 및 제약사항

### 9.1 API 사용 제한
| API | 제한 | 대응 방안 |
|-----|------|-----------|
| 네이버 검색 | 일 25,000건 | 키워드당 5건 제한 (1일 60건) |
| yfinance | 없음 | IP 차단 주의 (과도한 요청 금지) |
| ECOS | 1회 100,000건 | 일 3,000건 권장 |
| FRED | 120 requests/60초 | 배치 처리로 분산 |

### 9.2 라즈베리파이 리소스
| 항목 | 제약 | 대응 |
|------|------|------|
| CPU | 4코어, 낮은 성능 | 배치 처리, 야간 수집 |
| 메모리 | 8GB | 분할 수집, 청크 처리 |
| 스토리지 | 1TB | 압축, 정기 아카이브 |

---

## 10. 데이터 소스 확장 계획

### 10.1 단기 (3개월 이내)
- [ ] 미국 주요 기업 개별주 추가 (AAPL, MSFT, NVDA 등)
- [ ] 비트코인/이더리움 가격 추가 (Binance API)
- [ ] 한국 부동산 지표 (KB부동산 API)

### 10.2 중기 (6개월 이내)
- [ ] 외국인/기관 매매 데이터 (KRX 크롤링)
- [ ] 공매도 데이터 (금융위원회 공개 데이터)
- [ ] 주가 재무제표 데이터 (dart.fss.or.kr)

### 10.3 장기 (1년 이내)
- [ ] 소셜 미디어 감성 분석 (Twitter/Reddit API)
- [ ] 대체 데이터 (위성 이미지, 신용카드 데이터 등)
- [ ] 글로벌 섹터 ETF (유럽, 중국, 인도 등)

---

## 11. 의사결정 기록

### 11.1 주요 결정 사항

**Q: 왜 Bloomberg API를 사용하지 않나요?**
- A: 유료($2,000/월), 개인 프로젝트 예산 초과

**Q: 왜 15년 데이터를 선택했나요?**
- A: 5년은 경기 사이클 분석에 부족, 10년 이상 필요. yfinance/FRED/ECOS 모두 15년 이상 데이터 제공 가능

**Q: 왜 종목을 27개로 제한했나요?**
- A: 데이터 수집/처리 속도, 라즈베리파이 리소스 고려. 주요 섹터 대표 종목으로 충분

**Q: 왜 뉴스는 네이버 API를 사용하나요?**
- A: 무료이며 한국어 뉴스 커버리지가 가장 넓음. 감성분석은 Phase 3에서 진행

**Q: 왜 InfluxDB를 선택했나요?**
- A: 시계열 데이터 전용 DB, Grafana 네이티브 연동, 오픈소스, 라즈베리파이 호환

---

## 12. 참고 문서

| 문서 | 설명 |
|------|------|
| CLAUDE.md | 프로젝트 전체 개요 |
| DATACOLLECT.md | 데이터 수집 스크립트 상세 |
| DASHBOARD_DESIGN.md | 대시보드 설계 원칙 |
| CHANGELOG.md | 데이터 소스 변경 이력 |

---

*최종 업데이트: 2025-12-03*
*작성자: Claude Code*
